<%# TASK-057: Notification item partial - Enhanced with CRM best practices %>
<% target_url = notification.read? ? (notification.action_url.presence || notifications_path) : mark_as_read_notification_path(notification) %>

<%= link_to target_url,
            method: (notification.read? ? :get : :post),
            data: (notification.read? ? {} : { turbo_method: :post }),
            class: "block cursor-pointer group" do %>
  <div id="notification_<%= notification.id %>"
       class="flex items-start gap-4 px-4 py-4 border-b border-gray-100 transition-all duration-200
              <%= notification.read? ? 'bg-white hover:bg-gray-50' : 'bg-blue-50/70 hover:bg-blue-100/70' %>">

    <%# Icon with color based on notification type %>
    <div class="flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center shadow-sm <%= notification.color_class %>">
      <i class="fas <%= notification.resolved_icon %> text-sm"></i>
    </div>

    <%# Content %>
    <div class="flex-1 min-w-0">
      <div class="flex items-start justify-between gap-2">
        <p class="text-sm font-medium leading-snug <%= notification.read? ? 'text-gray-600' : 'text-gray-900' %>">
          <%= notification.title %>
        </p>
        <%# Unread indicator - blue dot %>
        <% unless notification.read? %>
          <span class="flex-shrink-0 mt-1.5 w-2 h-2 bg-blue-600 rounded-full"></span>
        <% end %>
      </div>

      <% if notification.body.present? %>
        <p class="mt-1 text-sm text-gray-500 line-clamp-2 leading-relaxed">
          <%= notification.body %>
        </p>
      <% end %>

      <p class="mt-2 text-xs text-gray-400 flex items-center gap-1">
        <i class="far fa-clock"></i>
        <%= time_ago_in_words(notification.created_at) %> trước
      </p>
    </div>

    <%# Action arrow on hover %>
    <div class="flex-shrink-0 self-center opacity-0 group-hover:opacity-100 transition-opacity">
      <i class="fas fa-chevron-right text-gray-400"></i>
    </div>
  </div>
<% end %>
