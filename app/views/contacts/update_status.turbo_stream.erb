<%# TASK-051: Turbo Stream response for status update %>

<%# Update the status progress bar %>
<%= turbo_stream.replace "status_progress" do %>
  <%= render "contacts/partials/status_progress", contact: @contact %>
<% end %>

<%# Update the status changer dropdown %>
<%= turbo_stream.replace "status_changer" do %>
  <%= render "contacts/partials/status_changer", contact: @contact %>
<% end %>

<%# Prepend new interaction to timeline (the transition is logged as interaction) %>
<% if @contact.interactions.any? %>
  <%= turbo_stream.replace "interactions_timeline" do %>
    <%= render "interactions/timeline", interactions: @contact.interactions.includes(:user).recent %>
  <% end %>
<% end %>

<%# Show success flash %>
<%= turbo_stream.prepend "flash_messages" do %>
  <div class="mb-4 p-4 rounded-lg bg-green-50 border border-green-200 text-green-700 animate-fade-in">
    <div class="flex items-center gap-2">
      <i class="fa-solid fa-check-circle"></i>
      <span>Đã chuyển trạng thái thành công</span>
    </div>
  </div>
<% end %>
