<turbo-frame id="contact_list_frame">
<div class="overflow-x-auto">
  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
      <tr>
        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kh√°ch h√†ng</th>
        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nhu c·∫ßu</th>
        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tr·∫°ng th√°i</th>
        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Th·ªùi gian</th>
        <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">H√†nh ƒë·ªông</th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
      <% contacts.each do |contact| %>
        <tr class="hover:bg-blue-50 cursor-pointer transition-colors group"
            data-action="click->workspace-tabs#showPreview"
            data-preview-url="<%= sales_workspace_preview_path(contact) %>">
          <!-- Customer Info -->
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="flex items-center">
              <div class="flex-shrink-0 h-10 w-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold text-sm shadow-sm">
                <%= contact.name.first.upcase %>
              </div>
              <div class="ml-4">
                <div class="text-sm font-semibold text-gray-900 group-hover:text-brand-blue"><%= contact.name %></div>
                <div class="text-xs text-gray-500 flex items-center space-x-2">
                  <span><%= contact.code %></span>
                  <span class="text-gray-300">|</span>
                  <span><%= contact.phone %></span>
                </div>
              </div>
            </div>
          </td>
          <!-- Service Type -->
          <td class="px-6 py-4 whitespace-nowrap">
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
              <%= contact.service_type&.name || "Ch∆∞a x√°c ƒë·ªãnh" %>
            </span>
          </td>
          <!-- Status -->
          <td class="px-6 py-4 whitespace-nowrap">
            <% status_colors = {
              'new_contact' => 'bg-blue-100 text-blue-800',
              'potential' => 'bg-yellow-100 text-yellow-800',
              'in_progress' => 'bg-green-100 text-green-800',
              'closed_new' => 'bg-emerald-100 text-emerald-800',
              'failed' => 'bg-red-100 text-red-800'
            } %>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium <%= status_colors[contact.status] || 'bg-gray-100 text-gray-800' %>">
              <%= contact.status_label %>
            </span>
          </td>
          <!-- Time -->
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
            <% if tab == :new_contacts %>
              <span title="T·∫°o l√∫c"><i class="fa-regular fa-clock mr-1"></i><%= time_ago_in_words(contact.created_at) %> tr∆∞·ªõc</span>
            <% else %>
              <span title="C·∫≠p nh·∫≠t l√∫c"><i class="fa-regular fa-clock mr-1"></i><%= time_ago_in_words(contact.updated_at) %> tr∆∞·ªõc</span>
            <% end %>
          </td>
          <!-- Actions -->
          <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
            <div class="flex items-center justify-end space-x-2">
              <% if tab == :new_contacts %>
                <!-- Pick Button -->
                <%= button_to pick_contact_path(contact), method: :post, 
                    class: "inline-flex items-center px-3 py-1.5 bg-brand-blue text-white text-xs font-medium rounded-md hover:bg-blue-700 transition-colors shadow-sm",
                    data: { turbo_confirm: "Nh·∫≠n kh√°ch h√†ng #{contact.name}?", turbo_frame: "_top" } do %>
                  <i class="fa-solid fa-hand-pointer mr-1.5"></i>Nh·∫≠n
                <% end %>
              <% else %>
                <!-- Update Button -->
                <%= link_to edit_contact_path(contact), 
                    class: "inline-flex items-center px-3 py-1.5 bg-orange-500 text-white text-xs font-medium rounded-md hover:bg-orange-600 transition-colors shadow-sm" do %>
                  <i class="fa-solid fa-pen mr-1.5"></i>C·∫≠p nh·∫≠t
                <% end %>
              <% end %>
            </div>
          </td>
        </tr>
      <% end %>
      <% if contacts.empty? %>
        <tr>
          <td colspan="5" class="px-6 py-16 text-center">
            <div class="text-gray-400">
              <i class="fa-solid fa-inbox text-4xl mb-3"></i>
              <p class="text-sm">
                <% case tab %>
                <% when :new_contacts %>
                  Kh√¥ng c√≥ kh√°ch h√†ng m·ªõi n√†o trong khu v·ª±c c·ªßa b·∫°n.
                <% when :needs_update %>
                  T·∫•t c·∫£ kh√°ch h√†ng ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t ƒë·∫ßy ƒë·ªß th√¥ng tin! üéâ
                <% when :in_progress %>
                  B·∫°n ch∆∞a c√≥ kh√°ch h√†ng n√†o ƒëang chƒÉm s√≥c.
                <% end %>
              </p>
            </div>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
</turbo-frame>
